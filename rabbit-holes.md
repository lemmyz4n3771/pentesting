## Dealing with Rabbit Holes

A rabbit hole in hacking refers to a path that doesn't advance the hacker towards compromise. Their existence can be either accidental or deliberate in design. If they are by design in some CTFs, the author may break the fourth wall to troll you. Any trolling is just telling you to modify you approach. It may not be the case that the endpoint you found isn't helpful or the bit of information you found cannot be used later or that the app isn't vulnerable to a particular attack. It just means, for moment, you aren't making headway.

Knowing how far to go down a rabbit hole is an important sense to develop. The real world of hacking has no such self-awareness and anytime you spend in a place you aren't expected to be generates noise without gain. Also, the author of a CTF doesn't have to be so generous as to alert you to change your strategy. As an attacker, you are owed nothing. Beggers can't be choosers.

Examples of rabbit holes include:

1. Difficult to crack hashes that can't be passed
2. Fake credentials or list of "users" that aren't really users
3. Directory structures that make no practical sense, such as being never-ending 
4. Filenames and file types that look too good to be true (especially early on in a CTF), like root's private ssh key 
5. An application that appears to be vulnerable in a particular way, but the vulnerability never seems to pay off. For example, the app could reveal through its version that it could be vulnerable to a CVE, but the PoC never works.

The latter group belongs to the most insidious of the rabbit holes because it goes to the heart of what it means to pentest and what makes it interesting: to test to see if something is vulnerable. If not tested enough,  you haven't done your job. If tested too much, you've wasted your time. It's also insidious because you're digging your own rabbit hole at some point, and the level of depth you achieve directly corresponds to your knowledge in the particular area. In other words, one's level of investigation into a fruitless endpoint is directly proportional to one's knowledge of ways to test that endpoint. The pessismist will say you are being punished for your depth of knowledge. But the pessimist will never be a hacker. Instead, the hacker will say his ability is exercised and knowledge increased through his efforts and he has emerged from the rabbit hole stronger and wiser. Still, there are better ways you can spend your time.

I'm not fond of thinking something is impossible, but I am willing to look around a bit more for something that is more quickly profitable, with fewer hoops to have to jump through. With this in mind, I've developed the following strategy for dealing with rabbit holes:

1. Have a high level of endurance
2. Gain enough information about a particular endpoint to get a feel for what is going on. Then, if the payoff does not match your suspicions after several tests, set it aside and move on.
3. Have some enumeration going on the background as you search for exploitable endpoints
4. Return to the "rabbit hole" if information from 2 and 3 indicate it wasn't a rabbit hole after all.

Endurance is a prime hacker trait because there will always be __a lot__ of obstacles before successful compromise. If there aren't any obstacles, then the challenge isn't a challenge, you will have learned nothing, and your success will feel hollow. The challenge __is__ what you're here for, but you also want to get ahead and not just stare at a wall. So if the challenge is worth doing, it will be full of obstacles. That you encounter resistence is part of the challenge. Resistence has the effect of making an engagement seem longer than really is because, once you find an exploitable path, you can focus on a single point and less on the periphery. But until that moment, you'll have to turn over every stone. "Enumerate harder" simply means that you haven't seen all there is to be seen, provided the machine is working properly (sometimes it isn't, which makes the challenge less fair, since then you're dealing with a mechanical fault that you'll likely get no explanation for, rather than handling the actual problem).

Endurance is a combination of physical strength and mental tolerance of trial and error. The physical part is staying alert and focused, like a chess player, and this does require physical fitness. Bobby Fischer, for example, made sure to eat well and play sports like tennis because he would be sitting for 4-5 hours at a game, which is extremely taxing to the physically unfit. Mental tolerance is more of a way of interpreting the grind of working on a problem until you find a solution so that you stay motivated. Consider one of Polya's suggestions from __How to Solve It__ that any time spent on solving the problem is never wasted. By staying in good spirits, you keep yourself fresh. Energy is like cash: the more you have of it, the more you can flex without feeling the pinch, the more you will see, the farther you will go.

Getting a feel for an endpoint is a matter of experience , research, and intuition. Experience and intuition can be substituted by using PoCs that other people have made and throwing them against the endpoint to see if it works. Of course, finding an applicable PoC depends on one's enumeration and research. The good thing is that these things are doable in the short run. By studying and using other people's work, you gain experience and intuition over time.

Running scans, brute forcing, and automatically enumerating in the background are wonderful ways to hack time, but it is not always possible to stack things in this way. Automatic enumeration is readily available at the beginning of an engagement and after you get a foothold on a machine, but I've found manual enumeration to be unavoidable at other times.

The nature of a rabbit hole is such that you believe it to be something that it isn't. By investigating it, you give it more context. It could be that you simply don't have enough context yet to make the rabbit hole more meaningful, hence the need to put it on the back-burner and keep it in mind if later evidence turns up that it has more use than being an idle curiosity.